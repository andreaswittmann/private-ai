<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-05-31 Sat 11:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LibreChat AWS Deployment - Live-Scripting Workflow</title>
<meta name="author" content="Privacy-Focused AI Implementation" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="aw-org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="aw-org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script type="text/javascript" src="aw-org-html-themes/styles/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="aw-org-html-themes/styles/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="aw-org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="aw-org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">LibreChat AWS Deployment - Live-Scripting Workflow</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orga006539">1. Building a Privacy-Focused AI Assistant: My Personal Journey</a>
<ul>
<li><a href="#org566e848">1.1. Why This Project Matters to Me</a></li>
<li><a href="#org0fd79c4">1.2. The Live-Scripting Methodology</a>
<ul>
<li><a href="#orgabb1b0f">1.2.1. For Emacs Users - Complete Implementation</a></li>
<li><a href="#org15db5b4">1.2.2. For Non-Emacs Users</a></li>
</ul>
</li>
<li><a href="#orgb4ce908">1.3. What We're Building Together</a></li>
<li><a href="#orgd112e91">1.4. Expected Journey Outcome</a></li>
</ul>
</li>
<li><a href="#orgb70712e">2. Part 1: Foundation &amp; Prerequisites</a>
<ul>
<li><a href="#org5d31b5d">2.1. Personal Environment Setup</a>
<ul>
<li><a href="#orga7a15fb">2.1.1. Setting the Project Foundation</a></li>
<li><a href="#org1301512">2.1.2. Validating AWS Prerequisites</a></li>
<li><a href="#org0ddd19f">2.1.3. Understanding the Architecture</a></li>
</ul>
</li>
<li><a href="#orgc73f8b8">2.2. Checkpoint: Environment Ready</a></li>
</ul>
</li>
<li><a href="#org52f0333">3. Part 2: Infrastructure as Code</a>
<ul>
<li><a href="#orgb2a16a1">3.1. Personal Reflection on Infrastructure Automation</a>
<ul>
<li><a href="#org7a86008">3.1.1. SSH Key Generation for Secure Access</a></li>
<li><a href="#org86d5e0f">3.1.2. Terraform Configuration and Planning</a></li>
<li><a href="#org10d1678">3.1.3. Infrastructure Deployment Planning</a></li>
<li><a href="#org7216d2d">3.1.4. Infrastructure Deployment Execution</a></li>
<li><a href="#org51628c2">3.1.5. SSH Configuration for Easy Access</a></li>
</ul>
</li>
<li><a href="#org54e2e15">3.2. Checkpoint: Infrastructure Operational</a></li>
</ul>
</li>
<li><a href="#orgc9e73bc">4. Part 3: Core LibreChat Deployment</a>
<ul>
<li><a href="#org67cf672">4.1. The Heart of the System: LibreChat Setup</a>
<ul>
<li><a href="#org2af89f6">4.1.1. Initial Environment Preparation</a></li>
<li><a href="#org68c14f9">4.1.2. LibreChat Repository and Docker Setup</a></li>
<li><a href="#org9e5a9c5">4.1.3. Local Configuration Preparation</a></li>
</ul>
</li>
<li><a href="#org8d86b26">4.2. Checkpoint: Basic System Working</a></li>
</ul>
</li>
<li><a href="#orge337c05">5. Part 4: Security &amp; Production Readiness</a>
<ul>
<li><a href="#org612153d">5.1. My Philosophy on Security</a>
<ul>
<li><a href="#orga04bcc4">5.1.1. SSL Certificate Generation and Deployment</a></li>
<li><a href="#orgd294227">5.1.2. Production Deployment with SSL</a></li>
<li><a href="#org3c2b733">5.1.3. AWS Bedrock Integration Configuration</a></li>
</ul>
</li>
<li><a href="#orgd963c34">5.2. Checkpoint: Production-Ready</a></li>
</ul>
</li>
<li><a href="#orgb9453fb">6. Part 5: Advanced Features - RAG Integration</a>
<ul>
<li><a href="#org6da87bb">6.1. Why RAG Matters for Privacy</a>
<ul>
<li><a href="#org2a130a0">6.1.1. Ollama Container Deployment</a></li>
<li><a href="#orgaa49a6f">6.1.2. RAG Environment Configuration</a></li>
<li><a href="#org15195ff">6.1.3. Advanced Model Installation (GPU Instance Upgrade)</a></li>
</ul>
</li>
<li><a href="#org27cc5ee">6.2. Checkpoint: Complete System</a></li>
</ul>
</li>
<li><a href="#orgfeba0f7">7. Troubleshooting &amp; Maintenance</a>
<ul>
<li><a href="#orgbc66bc3">7.1. Common Issues and Solutions</a>
<ul>
<li><a href="#org24ff8e0">7.1.1. Docker Container Issues</a></li>
<li><a href="#org73ee2cd">7.1.2. Performance Optimization</a></li>
<li><a href="#org6f86a3c">7.1.3. Cost Optimization Strategies</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org306a28c">8. Reflection &amp; Lessons Learned</a>
<ul>
<li><a href="#org6bc512b">8.1. Personal Insights from This Journey</a>
<ul>
<li><a href="#org1f976bd">8.1.1. Technical Insights</a></li>
<li><a href="#org686dbb2">8.1.2. Methodology Insights</a></li>
<li><a href="#org83426c3">8.1.3. Unexpected Discoveries</a></li>
</ul>
</li>
<li><a href="#org0ee617b">8.2. Alternative Approaches Considered</a>
<ul>
<li><a href="#org4603286">8.2.1. Different Infrastructure Options</a></li>
<li><a href="#orgf9b08a4">8.2.2. Security Enhancements for Production</a></li>
<li><a href="#org162737b">8.2.3. Cost Optimization Alternatives</a></li>
</ul>
</li>
<li><a href="#orge46e982">8.3. Future Enhancement Possibilities</a>
<ul>
<li><a href="#org54faaad">8.3.1. Advanced AI Features</a></li>
<li><a href="#org3fc93a1">8.3.2. Production Hardening</a></li>
<li><a href="#org77381a7">8.3.3. User Experience Improvements</a></li>
</ul>
</li>
<li><a href="#orgf0015cc">8.4. Final Thoughts</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orga006539" class="outline-2">
<h2 id="orga006539"><span class="section-number-2">1.</span> Building a Privacy-Focused AI Assistant: My Personal Journey</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org566e848" class="outline-3">
<h3 id="org566e848"><span class="section-number-3">1.1.</span> Why This Project Matters to Me</h3>
<div class="outline-text-3" id="text-1-1">
<p>
In an era where AI capabilities are rapidly expanding but privacy concerns remain paramount, I faced a personal challenge: How can I leverage powerful language models while maintaining complete control over my data and interactions? 
</p>

<p>
This project represents my solution—a fully self-hosted LibreChat deployment with AWS Bedrock integration that demonstrates how to achieve enterprise-grade AI capabilities without sacrificing privacy. The journey combines my passion for privacy-preserving technology with the practical need for powerful AI assistance in daily work.
</p>
</div>
</div>
<div id="outline-container-org0fd79c4" class="outline-3">
<h3 id="org0fd79c4"><span class="section-number-3">1.2.</span> The Live-Scripting Methodology</h3>
<div class="outline-text-3" id="text-1-2">
<p>
This implementation uses my live-scripting methodology, which I developed to transform static documentation into executable, interactive workflows. The core principle is simple: any code block in the documentation can be executed with a single keypress, creating a seamless bridge between documentation and execution.
</p>
</div>
<div id="outline-container-orgabb1b0f" class="outline-4">
<h4 id="orgabb1b0f"><span class="section-number-4">1.2.1.</span> For Emacs Users - Complete Implementation</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Here's the complete Emacs Lisp function that enables live-scripting:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #77492f;">;; </span><span style="color: #77492f;">live-scripting mit vterm.</span>
<span style="color: #0031a9;">(</span><span style="color: #531ab6;">defun</span> <span style="color: #721045;">send-line-to-vterm</span> <span style="color: #695500;">()</span>
  <span style="color: #2a5045;">"Send region if active, or current line to vterm buffer. Then move to next line."</span>
  <span style="color: #695500;">(</span><span style="color: #531ab6;">interactive</span><span style="color: #695500;">)</span>
  <span style="color: #695500;">(</span><span style="color: #531ab6;">if</span> <span style="color: #3548cf;">(</span>region-active-p<span style="color: #3548cf;">)</span>
      <span style="color: #3548cf;">(</span>send-region <span style="color: #3548cf;">"*vterm*"</span> <span style="color: #77492f;">(</span>region-beginning<span style="color: #77492f;">)</span> <span style="color: #77492f;">(</span>region-end<span style="color: #77492f;">)</span><span style="color: #3548cf;">)</span>
    <span style="color: #3548cf;">(</span>my-select-current-line<span style="color: #3548cf;">)</span>
    <span style="color: #3548cf;">(</span>send-region <span style="color: #3548cf;">"*vterm*"</span> <span style="color: #77492f;">(</span>region-beginning<span style="color: #77492f;">)</span> <span style="color: #77492f;">(</span>region-end<span style="color: #77492f;">)</span><span style="color: #3548cf;">)</span><span style="color: #695500;">)</span>
  <span style="color: #695500;">(</span>deactivate-mark<span style="color: #695500;">)</span><span style="color: #0031a9;">)</span>

<span style="color: #77492f;">;; </span><span style="color: #77492f;">Key bindings - choose what works best for you</span>
<span style="color: #0031a9;">(</span>global-set-key <span style="color: #695500;">[</span>f4<span style="color: #695500;">]</span> 'send-line-to-vterm<span style="color: #0031a9;">)</span>
<span style="color: #77492f;">;; </span><span style="color: #77492f;">Alternative binding:</span>
<span style="color: #0031a9;">(</span>global-set-key <span style="color: #695500;">(</span>kbd <span style="color: #3548cf;">"S-&lt;return&gt;"</span><span style="color: #695500;">)</span> 'send-line-to-vterm<span style="color: #0031a9;">)</span>
</pre>
</div>

<p>
The F4 key (or Shift+Return) is my personal preference, but you can bind it to any key combination that suits your workflow.
</p>
</div>
</div>
<div id="outline-container-org15db5b4" class="outline-4">
<h4 id="org15db5b4"><span class="section-number-4">1.2.2.</span> For Non-Emacs Users</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
The methodology works perfectly with any text editor and terminal combination - simply copy and paste code blocks into your terminal. The live-scripting approach maintains the same level of precision and reproducibility regardless of your tools.
</p>
</div>
</div>
</div>
<div id="outline-container-orgb4ce908" class="outline-3">
<h3 id="orgb4ce908"><span class="section-number-3">1.3.</span> What We're Building Together</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li><b><b>Complete privacy control</b></b>: Self-hosted LibreChat with AWS Bedrock models (Claude, Nova, DeepSeek)</li>
<li><b><b>Production-ready foundation</b></b>: SSL/HTTPS, Docker containerization, infrastructure automation</li>
<li><b><b>Advanced AI capabilities</b></b>: RAG functionality, multi-model support, document processing</li>
<li><b><b>Reproducible methodology</b></b>: Live-scripting workflow that others can follow and adapt</li>
</ul>
</div>
</div>
<div id="outline-container-orgd112e91" class="outline-3">
<h3 id="orgd112e91"><span class="section-number-3">1.4.</span> Expected Journey Outcome</h3>
<div class="outline-text-3" id="text-1-4">
<p>
By the end of this workflow, you'll have a functioning HTTPS-enabled LibreChat instance running on AWS, integrated with multiple Bedrock models, and enhanced with RAG capabilities - all under your complete control.
</p>
</div>
</div>
</div>
<div id="outline-container-orgb70712e" class="outline-2">
<h2 id="orgb70712e"><span class="section-number-2">2.</span> Part 1: Foundation &amp; Prerequisites</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org5d31b5d" class="outline-3">
<h3 id="org5d31b5d"><span class="section-number-3">2.1.</span> Personal Environment Setup</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Let me start by establishing my development environment and validating the prerequisites.
</p>
</div>
<div id="outline-container-orga7a15fb" class="outline-4">
<h4 id="orga7a15fb"><span class="section-number-4">2.1.1.</span> Setting the Project Foundation</h4>
<div class="outline-text-4" id="text-2-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Project environment setup</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Establishing the base directory for our privacy-focused AI project</span>

<span style="color: #005e8b;">PROJECT_DIR</span>=<span style="color: #3548cf;">"/Users/$(whoami)/LocalProjects/ai-bootcamp/private-ai"</span>
<span style="color: #8f0075;">cd</span> <span style="color: #3548cf;">"$PROJECT_DIR"</span>
<span style="color: #8f0075;">pwd</span>
ls -la

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify we're in the right location</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"Working in: $PROJECT_DIR"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Set AWS profile for this session</span>
<span style="color: #8f0075;">export</span> <span style="color: #005e8b;">AWS_PROFILE</span>=lab-a
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"AWS Profile: $AWS_PROFILE"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1301512" class="outline-4">
<h4 id="org1301512"><span class="section-number-4">2.1.2.</span> Validating AWS Prerequisites</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
Before proceeding, I need to confirm my AWS environment is properly configured for this deployment.
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: AWS environment validation</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Ensuring AWS access and Bedrock availability</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test basic AWS connectivity</span>
aws s3 ls

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify AWS identity and permissions</span>
aws sts get-caller-identity

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check if AWS Session Manager plugin is available</span>
session-manager-plugin --version

<span style="color: #77492f;"># </span><span style="color: #77492f;">Validate required tools are installed</span>
terraform --version
git --version
docker --version
</pre>
</div>
</div>
</div>
<div id="outline-container-org0ddd19f" class="outline-4">
<h4 id="org0ddd19f"><span class="section-number-4">2.1.3.</span> Understanding the Architecture</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
This deployment creates a privacy-focused AI system with these key components:
</p>

<ul class="org-ul">
<li><b><b>AWS EC2 Instance</b></b>: Automated provisioning via Terraform</li>
<li><b><b>LibreChat</b></b>: Containerized deployment with Docker Compose</li>
<li><b><b>AWS Bedrock Integration</b></b>: Multiple AI models (Claude, Nova, DeepSeek)</li>
<li><b><b>RAG Capabilities</b></b>: Ollama integration for document processing</li>
<li><b><b>Security Layer</b></b>: SSL/HTTPS, security groups, IAM roles</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc73f8b8" class="outline-3">
<h3 id="orgc73f8b8"><span class="section-number-3">2.2.</span> Checkpoint: Environment Ready</h3>
<div class="outline-text-3" id="text-2-2">
<p>
At this point, I should have:
</p>
<ul class="org-ul">
<li>✅ Project directory established</li>
<li>✅ AWS credentials validated</li>
<li>✅ Required tools confirmed available</li>
<li>✅ Architecture understanding clear</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org52f0333" class="outline-2">
<h2 id="org52f0333"><span class="section-number-2">3.</span> Part 2: Infrastructure as Code</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgb2a16a1" class="outline-3">
<h3 id="orgb2a16a1"><span class="section-number-3">3.1.</span> Personal Reflection on Infrastructure Automation</h3>
<div class="outline-text-3" id="text-3-1">
<p>
One of the most satisfying aspects of this project is the infrastructure automation. Rather than manually clicking through AWS consoles, I can reproduce the entire environment with code - perfect for experimenting, learning, and sharing.
</p>
</div>
<div id="outline-container-org7a86008" class="outline-4">
<h4 id="org7a86008"><span class="section-number-4">3.1.1.</span> SSH Key Generation for Secure Access</h4>
<div class="outline-text-4" id="text-3-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: SSH key generation for EC2 access</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Creating dedicated SSH keys for secure instance access</span>

<span style="color: #8f0075;">cd</span> <span style="color: #3548cf;">"$PROJECT_DIR"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Generate a new SSH key pair specifically for LibreChat</span>
ssh-keygen -t rsa -b 4096 -f ~/.ssh/librechat_key -N <span style="color: #3548cf;">""</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Display the public key for use in Terraform variables</span>
cat ~/.ssh/librechat_key.pub

<span style="color: #77492f;"># </span><span style="color: #77492f;">Store public key in environment variable</span>
<span style="color: #8f0075;">export</span> <span style="color: #005e8b;">TF_VAR_SSH_PUBLIC_KEY</span>=<span style="color: #3548cf;">"$(cat ~/.ssh/librechat_key.pub)"</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"SSH public key configured: $TF_VAR_SSH_PUBLIC_KEY"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org86d5e0f" class="outline-4">
<h4 id="org86d5e0f"><span class="section-number-4">3.1.2.</span> Terraform Configuration and Planning</h4>
<div class="outline-text-4" id="text-3-1-2">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Terraform environment preparation</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Setting up infrastructure configuration</span>

<span style="color: #8f0075;">cd</span> <span style="color: #3548cf;">"$PROJECT_DIR/terraform"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Create terraform variables file with our configuration</span>
cat &gt; terraform.tfvars &lt;&lt; EOF
<span style="color: #3548cf;"># Generated tfvars file - $(date)</span>
<span style="color: #3548cf;">aws_region       = "eu-central-1"</span>
<span style="color: #3548cf;">instance_type    = "t3.medium"</span>
<span style="color: #3548cf;">root_volume_size = 30</span>
<span style="color: #3548cf;">root_volume_type = "gp3"</span>
<span style="color: #3548cf;">allowed_ip       = "0.0.0.0/0"</span>
<span style="color: #3548cf;">ssh_public_key   = "${TF_VAR_SSH_PUBLIC_KEY}"</span>
<span style="color: #3548cf;">ec2_name         = "EC2-LibreChat"</span>
<span style="color: #3548cf;">environment      = "development"</span>
<span style="color: #3548cf;">project          = "private-ai"</span>
<span style="color: #3548cf;">ssh_cidr_blocks  = ["0.0.0.0/0"]</span>
<span style="color: #3548cf;">EOF</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Review our configuration</span>
cat terraform.tfvars

<span style="color: #77492f;"># </span><span style="color: #77492f;">Initialize Terraform</span>
terraform init

<span style="color: #77492f;"># </span><span style="color: #77492f;">Format and validate our configuration</span>
terraform fmt
terraform validate
</pre>
</div>
</div>
</div>
<div id="outline-container-org10d1678" class="outline-4">
<h4 id="org10d1678"><span class="section-number-4">3.1.3.</span> Infrastructure Deployment Planning</h4>
<div class="outline-text-4" id="text-3-1-3">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Terraform deployment planning</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Creating and reviewing the deployment plan</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Generate deployment plan</span>
terraform plan -out=tfplan -var-file=terraform.tfvars

<span style="color: #77492f;"># </span><span style="color: #77492f;">Create human-readable plan</span>
terraform show -json tfplan &gt; tfplan.json
cat tfplan.json | jq &gt; tfplan.pretty.json

<span style="color: #77492f;"># </span><span style="color: #77492f;">Review what resources will be created</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"Resources to be created:"</span>
cat tfplan.json | jq <span style="color: #3548cf;">'.resource_changes[] | {address: .address, action: .change.actions[0]}'</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Summary of planned changes</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"Deployment summary:"</span>
cat tfplan.json | jq <span style="color: #3548cf;">'.resource_changes | group_by(.change.actions[0]) | map({action: .[0].change.actions[0], count: length})'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7216d2d" class="outline-4">
<h4 id="org7216d2d"><span class="section-number-4">3.1.4.</span> Infrastructure Deployment Execution</h4>
<div class="outline-text-4" id="text-3-1-4">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: AWS infrastructure deployment</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Bringing our infrastructure to life</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Execute the deployment plan</span>
terraform apply tfplan

<span style="color: #77492f;"># </span><span style="color: #77492f;">Capture and display outputs</span>
terraform output

<span style="color: #77492f;"># </span><span style="color: #77492f;">List our EC2 instances</span>
aws ec2 describe-instances <span style="color: #3548cf;">\</span>
  --query <span style="color: #3548cf;">'Reservations[*].Instances[*].[InstanceId, InstanceType, Tags[?Key==`Name`]|[0].Value, State.Name]'</span> <span style="color: #3548cf;">\</span>
  --output text

<span style="color: #77492f;"># </span><span style="color: #77492f;">Get our instance details</span>
<span style="color: #005e8b;">instance_id</span>=$(aws ec2 describe-instances <span style="color: #3548cf;">\</span>
  --filters <span style="color: #3548cf;">"Name=tag:Name,Values=EC2-LibreChat"</span> <span style="color: #3548cf;">\</span>
  --query <span style="color: #3548cf;">'Reservations[*].Instances[*].[InstanceId]'</span> <span style="color: #3548cf;">\</span>
  --output text | grep -v <span style="color: #3548cf;">'^$'</span>)
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"Instance ID: $instance_id"</span>

<span style="color: #005e8b;">public_ip</span>=$(aws ec2 describe-instances <span style="color: #3548cf;">\</span>
  --instance-ids <span style="color: #3548cf;">"$instance_id"</span> <span style="color: #3548cf;">\</span>
  --query <span style="color: #3548cf;">'Reservations[*].Instances[*].[PublicIpAddress]'</span> <span style="color: #3548cf;">\</span>
  --output text)
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"Public IP: $public_ip"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org51628c2" class="outline-4">
<h4 id="org51628c2"><span class="section-number-4">3.1.5.</span> SSH Configuration for Easy Access</h4>
<div class="outline-text-4" id="text-3-1-5">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: SSH configuration setup</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Establishing convenient SSH access</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test initial SSH connection</span>
ssh -i ~/.ssh/librechat_key ec2-user@<span style="color: #3548cf;">"$public_ip"</span> <span style="color: #3548cf;">'whoami &amp;&amp; pwd'</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Create SSH config entry for easy access</span>
cat &gt;&gt; ~/.ssh/config &lt;&lt; EOF

<span style="color: #3548cf;"># SSH over EC2 - LibreChat Privacy AI Project</span>
<span style="color: #3548cf;">Host EC2-LibreChat</span>
<span style="color: #3548cf;">    HostName $public_ip</span>
<span style="color: #3548cf;">    User ec2-user</span>
<span style="color: #3548cf;">    IdentityFile ~/.ssh/librechat_key</span>
<span style="color: #3548cf;">EOF</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test SSH with hostname</span>
ssh EC2-LibreChat <span style="color: #3548cf;">'whoami &amp;&amp; date'</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org54e2e15" class="outline-3">
<h3 id="org54e2e15"><span class="section-number-3">3.2.</span> Checkpoint: Infrastructure Operational</h3>
<div class="outline-text-3" id="text-3-2">
<p>
At this milestone, I have:
</p>
<ul class="org-ul">
<li>✅ AWS EC2 instance running and accessible</li>
<li>✅ SSH keys generated and configured</li>
<li>✅ Network security properly configured</li>
<li>✅ Infrastructure documented in code</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc9e73bc" class="outline-2">
<h2 id="orgc9e73bc"><span class="section-number-2">4.</span> Part 3: Core LibreChat Deployment</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org67cf672" class="outline-3">
<h3 id="org67cf672"><span class="section-number-3">4.1.</span> The Heart of the System: LibreChat Setup</h3>
<div class="outline-text-3" id="text-4-1">
<p>
This is where the magic happens - transforming a bare EC2 instance into a powerful, privacy-respecting AI assistant platform.
</p>
</div>
<div id="outline-container-org2af89f6" class="outline-4">
<h4 id="org2af89f6"><span class="section-number-4">4.1.1.</span> Initial Environment Preparation</h4>
<div class="outline-text-4" id="text-4-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: EC2 environment preparation</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Setting up the foundation for LibreChat</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Connect to our instance</span>
ssh EC2-LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Update the system</span>
sudo yum update -y

<span style="color: #77492f;"># </span><span style="color: #77492f;">Create necessary directories for persistent volumes</span>
sudo mkdir -p /opt/librechat/mongodb
sudo mkdir -p /opt/portainer/data
sudo mkdir -p /opt/portainer/data/certs

<span style="color: #77492f;"># </span><span style="color: #77492f;">Set appropriate permissions</span>
sudo chmod -R 777 /opt/portainer/data
sudo chmod -R 777 /opt/librechat/mongodb

<span style="color: #77492f;"># </span><span style="color: #77492f;">Exit for now - we'll return with specific tasks</span>
<span style="color: #531ab6;">exit</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org68c14f9" class="outline-4">
<h4 id="org68c14f9"><span class="section-number-4">4.1.2.</span> LibreChat Repository and Docker Setup</h4>
<div class="outline-text-4" id="text-4-1-2">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: LibreChat clone and Docker installation</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Getting LibreChat and preparing containerization</span>

ssh EC2-LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Clone the LibreChat repository</span>
git clone https://github.com/danny-avila/LibreChat.git
<span style="color: #8f0075;">cd</span> LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Install docker-compose</span>
sudo curl -L <span style="color: #3548cf;">"https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)"</span> -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify installation</span>
docker-compose --version

<span style="color: #77492f;"># </span><span style="color: #77492f;">Initial LibreChat preparation</span>
cp .env.example .env

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test basic docker-compose functionality</span>
docker-compose up -d
docker ps -a
docker-compose down

<span style="color: #531ab6;">exit</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9e5a9c5" class="outline-4">
<h4 id="org9e5a9c5"><span class="section-number-4">4.1.3.</span> Local Configuration Preparation</h4>
<div class="outline-text-4" id="text-4-1-3">
<p>
Back on my local machine, I need to prepare the configuration files that will enable HTTPS and production deployment.
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Local configuration file preparation</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Preparing production configurations locally</span>

<span style="color: #8f0075;">cd</span> <span style="color: #3548cf;">"$PROJECT_DIR"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Copy docker-compose override file for SSL/HTTPS deployment</span>
scp <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/docker-compose.override.yml ec2-user@EC2-LibreChat:~/LibreChat/docker-compose.override.yml

<span style="color: #77492f;"># </span><span style="color: #77492f;">Backup and copy deploy-compose.yml with SSL configuration</span>
ssh EC2-LibreChat <span style="color: #3548cf;">"cp ~/LibreChat/deploy-compose.yml ~/LibreChat/deploy-compose.yml.bak"</span>
scp <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/deploy-compose.yml ec2-user@EC2-LibreChat:~/LibreChat/deploy-compose.yml

<span style="color: #77492f;"># </span><span style="color: #77492f;">Copy NGINX configuration with SSL</span>
ssh EC2-LibreChat <span style="color: #3548cf;">"cp ~/LibreChat/client/nginx.conf ~/LibreChat/client/nginx.conf.bak"</span>
scp <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/client/nginx.conf ec2-user@EC2-LibreChat:~/LibreChat/client/nginx.conf

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify the differences</span>
ssh EC2-LibreChat <span style="color: #3548cf;">"diff ~/LibreChat/deploy-compose.yml ~/LibreChat/deploy-compose.yml.bak"</span>
ssh EC2-LibreChat <span style="color: #3548cf;">"diff ~/LibreChat/client/nginx.conf ~/LibreChat/client/nginx.conf.bak"</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8d86b26" class="outline-3">
<h3 id="org8d86b26"><span class="section-number-3">4.2.</span> Checkpoint: Basic System Working</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Progress check:
</p>
<ul class="org-ul">
<li>✅ LibreChat repository cloned and prepared</li>
<li>✅ Docker environment configured</li>
<li>✅ Production configuration files in place</li>
<li>✅ Ready for SSL and security setup</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge337c05" class="outline-2">
<h2 id="orge337c05"><span class="section-number-2">5.</span> Part 4: Security &amp; Production Readiness</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org612153d" class="outline-3">
<h3 id="org612153d"><span class="section-number-3">5.1.</span> My Philosophy on Security</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Security isn't an afterthought in this deployment - it's built in from the beginning. Self-hosting gives us complete control, but with that comes the responsibility to secure our system properly.
</p>
</div>
<div id="outline-container-orga04bcc4" class="outline-4">
<h4 id="orga04bcc4"><span class="section-number-4">5.1.1.</span> SSL Certificate Generation and Deployment</h4>
<div class="outline-text-4" id="text-5-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: SSL certificate setup for HTTPS</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Implementing secure communications</span>

ssh EC2-LibreChat

<span style="color: #8f0075;">cd</span> ~/LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Create SSL directory</span>
mkdir -p client/ssl

<span style="color: #77492f;"># </span><span style="color: #77492f;">Generate self-signed SSL certificate for HTTPS</span>
openssl req -x509 -nodes -days 365 -newkey rsa:2048 <span style="color: #3548cf;">\</span>
  -keyout client/ssl/nginx.key <span style="color: #3548cf;">\</span>
  -out client/ssl/nginx.crt <span style="color: #3548cf;">\</span>
  -subj <span style="color: #3548cf;">"/C=US/ST=State/L=City/O=Organization/CN=localhost"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify SSL files</span>
ls -la client/ssl/

<span style="color: #77492f;"># </span><span style="color: #77492f;">Update environment for HTTPS domains</span>
cat .env | grep -iE <span style="color: #3548cf;">'DOMAIN_CLIENT|DOMAIN_SERVER'</span>
sed -i <span style="color: #3548cf;">'s|\(DOMAIN_.*=\)http://|\1https://|'</span> .env

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify HTTPS configuration</span>
grep -E <span style="color: #3548cf;">'DOMAIN_CLIENT|DOMAIN_SERVER'</span> .env

<span style="color: #77492f;"># </span><span style="color: #77492f;">Create librechat.yaml configuration file</span>
touch librechat.yaml

<span style="color: #531ab6;">exit</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd294227" class="outline-4">
<h4 id="orgd294227"><span class="section-number-4">5.1.2.</span> Production Deployment with SSL</h4>
<div class="outline-text-4" id="text-5-1-2">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Production deployment launch</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Starting LibreChat with full HTTPS and security</span>

ssh EC2-LibreChat

<span style="color: #8f0075;">cd</span> ~/LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Stop any running services</span>
docker-compose -f deploy-compose.yml -f docker-compose.override.yml down

<span style="color: #77492f;"># </span><span style="color: #77492f;">Start production deployment with SSL</span>
docker-compose -f deploy-compose.yml -f docker-compose.override.yml up -d

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify all containers are running</span>
docker ps -a

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check service logs for any issues</span>
docker logs $(docker ps -q --filter <span style="color: #3548cf;">"name=LibreChat-API"</span>)

<span style="color: #531ab6;">exit</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Display our public IP for browser access</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"LibreChat is now accessible at: https://$public_ip"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3c2b733" class="outline-4">
<h4 id="org3c2b733"><span class="section-number-4">5.1.3.</span> AWS Bedrock Integration Configuration</h4>
<div class="outline-text-4" id="text-5-1-3">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: AWS Bedrock model configuration</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Integrating AWS Bedrock AI models</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Prepare local environment configuration</span>
<span style="color: #8f0075;">cd</span> <span style="color: #3548cf;">"$PROJECT_DIR"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Copy and prepare .env file locally</span>
scp ec2-user@EC2-LibreChat:~/LibreChat/.env.example <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/.env.example
cp <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/.env.example <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/.env

<span style="color: #77492f;"># </span><span style="color: #77492f;">Add AWS Bedrock configuration</span>
cat &gt;&gt; <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/.env &lt;&lt; EOF

<span style="color: #3548cf;">#=================#</span>
<span style="color: #3548cf;">#   AWS Bedrock   #</span>
<span style="color: #3548cf;">#=================#</span>

<span style="color: #3548cf;">BEDROCK_AWS_DEFAULT_REGION=us-east-1 </span>
<span style="color: #3548cf;">BEDROCK_AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID</span>
<span style="color: #3548cf;">BEDROCK_AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY</span>

<span style="color: #3548cf;"># Claude models</span>
<span style="color: #3548cf;">ANTHROPIC_CLAUDE_3_5_SONNET_20241022_V2_0=true</span>
<span style="color: #3548cf;">ANTHROPIC_CLAUDE_3_5_HAIKU_20241022_V2_0=true</span>
<span style="color: #3548cf;">ANTHROPIC_CLAUDE_3_OPUS_20240229_V1_0=true</span>

<span style="color: #3548cf;"># Nova models  </span>
<span style="color: #3548cf;">AMAZON_NOVA_PRO_V1_0=true</span>
<span style="color: #3548cf;">AMAZON_NOVA_LITE_V1_0=true</span>
<span style="color: #3548cf;">AMAZON_NOVA_MICRO_V1_0=true</span>

<span style="color: #3548cf;"># DeepSeek models</span>
<span style="color: #3548cf;">DEEPSEEK_DEEPSEEK_V3=true</span>
<span style="color: #3548cf;">EOF</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Display configuration (without secrets)</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"AWS Bedrock configuration added:"</span>
tail -n 20 <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/.env | grep -v SECRET

<span style="color: #77492f;"># </span><span style="color: #77492f;">Upload updated configuration</span>
scp <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/.env ec2-user@EC2-LibreChat:~/LibreChat/.env

<span style="color: #77492f;"># </span><span style="color: #77492f;">Restart services with new configuration</span>
ssh EC2-LibreChat <span style="color: #3548cf;">'</span>
<span style="color: #3548cf;">cd ~/LibreChat</span>
<span style="color: #3548cf;">docker-compose -f deploy-compose.yml -f docker-compose.override.yml down</span>
<span style="color: #3548cf;">docker-compose -f deploy-compose.yml -f docker-compose.override.yml up -d</span>
<span style="color: #3548cf;">'</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd963c34" class="outline-3">
<h3 id="orgd963c34"><span class="section-number-3">5.2.</span> Checkpoint: Production-Ready</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Security milestone achieved:
</p>
<ul class="org-ul">
<li>✅ HTTPS/SSL enabled with proper certificates</li>
<li>✅ Production Docker deployment running</li>
<li>✅ AWS Bedrock models configured and accessible</li>
<li>✅ System accessible via secure web interface</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb9453fb" class="outline-2">
<h2 id="orgb9453fb"><span class="section-number-2">6.</span> Part 5: Advanced Features - RAG Integration</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org6da87bb" class="outline-3">
<h3 id="org6da87bb"><span class="section-number-3">6.1.</span> Why RAG Matters for Privacy</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Retrieval Augmented Generation (RAG) represents the pinnacle of this privacy-focused approach. Instead of sending sensitive documents to external AI services, I can process them locally while still leveraging powerful cloud models for reasoning.
</p>
</div>
<div id="outline-container-org2a130a0" class="outline-4">
<h4 id="org2a130a0"><span class="section-number-4">6.1.1.</span> Ollama Container Deployment</h4>
<div class="outline-text-4" id="text-6-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Ollama installation for local RAG processing</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Setting up local model inference for embeddings</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Prepare Ollama-specific Docker configuration</span>
<span style="color: #8f0075;">cd</span> <span style="color: #3548cf;">"$PROJECT_DIR"</span>
scp <span style="color: #3548cf;">"$PROJECT_DIR"</span>/LibreChat/docker-compose.override.yml.ollama ec2-user@EC2-LibreChat:~/LibreChat/docker-compose.override.yml

<span style="color: #77492f;"># </span><span style="color: #77492f;">Deploy with Ollama integration</span>
ssh EC2-LibreChat <span style="color: #3548cf;">'</span>
<span style="color: #3548cf;">cd ~/LibreChat</span>
<span style="color: #3548cf;">docker-compose -f deploy-compose.yml -f docker-compose.override.yml down</span>
<span style="color: #3548cf;">docker-compose -f deploy-compose.yml -f docker-compose.override.yml up -d</span>
<span style="color: #3548cf;">docker ps -a</span>
<span style="color: #3548cf;">'</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Install embedding model</span>
ssh EC2-LibreChat <span style="color: #3548cf;">'</span>
<span style="color: #3548cf;">docker exec -it $(docker ps -q --filter "name=ollama") bash -c "</span>
<span style="color: #3548cf;">ollama --version</span>
<span style="color: #3548cf;">ollama pull nomic-embed-text</span>
<span style="color: #3548cf;">ollama list</span>
<span style="color: #3548cf;">"</span>
<span style="color: #3548cf;">'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaa49a6f" class="outline-4">
<h4 id="orgaa49a6f"><span class="section-number-4">6.1.2.</span> RAG Environment Configuration</h4>
<div class="outline-text-4" id="text-6-1-2">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: RAG environment setup</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Configuring LibreChat for local RAG processing</span>

ssh EC2-LibreChat

<span style="color: #8f0075;">cd</span> ~/LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Add Ollama RAG configuration to environment</span>
cat &gt;&gt; .env &lt;&lt; EOF

<span style="color: #3548cf;">#=================#</span>
<span style="color: #3548cf;">#   Ollama RAG    #</span>
<span style="color: #3548cf;">#=================#</span>
<span style="color: #3548cf;"># Use Ollama for embeddings</span>
<span style="color: #3548cf;">RAG_API_URL=http://host.docker.internal:8000</span>
<span style="color: #3548cf;">EMBEDDINGS_PROVIDER=ollama</span>
<span style="color: #3548cf;">OLLAMA_BASE_URL=http://host.docker.internal:11434</span>
<span style="color: #3548cf;">EMBEDDINGS_MODEL=nomic-embed-text</span>
<span style="color: #3548cf;">EOF</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Verify configuration</span>
tail -n 10 .env

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test Ollama API connectivity</span>
docker exec -it $(docker ps -q --filter <span style="color: #3548cf;">"name=rag_api"</span>) sh -c <span style="color: #3548cf;">"</span>
<span style="color: #3548cf;">curl http://ollama:11434/api/version</span>
<span style="color: #3548cf;">"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test embeddings API</span>
docker exec -it $(docker ps -q --filter <span style="color: #3548cf;">"name=ollama"</span>) sh -c <span style="color: #3548cf;">"</span>
<span style="color: #3548cf;">curl http://localhost:11434/api/embeddings -d '{</span>
<span style="color: #3548cf;">  \"model\": \"nomic-embed-text\",</span>
<span style="color: #3548cf;">  \"prompt\": \"Testing embedding generation for RAG\"</span>
<span style="color: #3548cf;">}'</span>
<span style="color: #3548cf;">"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Restart services with RAG configuration</span>
docker-compose -f deploy-compose.yml -f docker-compose.override.yml down
docker-compose -f deploy-compose.yml -f docker-compose.override.yml up -d

<span style="color: #531ab6;">exit</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org15195ff" class="outline-4">
<h4 id="org15195ff"><span class="section-number-4">6.1.3.</span> Advanced Model Installation (GPU Instance Upgrade)</h4>
<div class="outline-text-4" id="text-6-1-3">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Advanced model deployment</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Installing additional models for enhanced capabilities</span>

ssh EC2-LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Access Ollama container for model management</span>
docker exec -it $(docker ps -q --filter <span style="color: #3548cf;">"name=ollama"</span>) bash

<span style="color: #77492f;"># </span><span style="color: #77492f;">Install additional models for various use cases</span>
ollama pull deepseek-r1:8b
ollama pull allenporter/xlam:7b  <span style="color: #77492f;"># </span><span style="color: #77492f;">Tool-capable model for RAG</span>
ollama pull mistral-nemo

<span style="color: #77492f;"># </span><span style="color: #77492f;">List all available models</span>
ollama list

<span style="color: #77492f;"># </span><span style="color: #77492f;">Test model functionality</span>
curl -X POST http://localhost:11434/api/generate <span style="color: #3548cf;">\</span>
     -H <span style="color: #3548cf;">"Content-Type: application/json"</span> <span style="color: #3548cf;">\</span>
     -d <span style="color: #3548cf;">'{</span>
<span style="color: #3548cf;">        "model": "mistral-nemo",</span>
<span style="color: #3548cf;">        "prompt": "What is the capital of Spain?",</span>
<span style="color: #3548cf;">        "max_tokens": 50</span>
<span style="color: #3548cf;">     }'</span>

<span style="color: #531ab6;">exit</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Exit container</span>
<span style="color: #531ab6;">exit</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Restart services to integrate new models</span>
<span style="color: #8f0075;">cd</span> ~/LibreChat
docker-compose -f deploy-compose.yml -f docker-compose.override.yml down
docker-compose -f deploy-compose.yml -f docker-compose.override.yml up -d

<span style="color: #531ab6;">exit</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org27cc5ee" class="outline-3">
<h3 id="org27cc5ee"><span class="section-number-3">6.2.</span> Checkpoint: Complete System</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Full functionality achieved:
</p>
<ul class="org-ul">
<li>✅ RAG functionality operational with Ollama</li>
<li>✅ Local embedding generation working</li>
<li>✅ Multiple AI models available (local + cloud)</li>
<li>✅ Document processing capabilities enabled</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgfeba0f7" class="outline-2">
<h2 id="orgfeba0f7"><span class="section-number-2">7.</span> Troubleshooting &amp; Maintenance</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgbc66bc3" class="outline-3">
<h3 id="orgbc66bc3"><span class="section-number-3">7.1.</span> Common Issues and Solutions</h3>
<div class="outline-text-3" id="text-7-1">
<p>
From my experience deploying this system, here are the most frequent issues and their solutions:
</p>
</div>
<div id="outline-container-org24ff8e0" class="outline-4">
<h4 id="org24ff8e0"><span class="section-number-4">7.1.1.</span> Docker Container Issues</h4>
<div class="outline-text-4" id="text-7-1-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Container troubleshooting</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Diagnosing and resolving container problems</span>

ssh EC2-LibreChat

<span style="color: #8f0075;">cd</span> ~/LibreChat

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check container status</span>
docker ps -a

<span style="color: #77492f;"># </span><span style="color: #77492f;">View container logs</span>
docker logs $(docker ps -q --filter <span style="color: #3548cf;">"name=LibreChat-API"</span>)
docker logs $(docker ps -q --filter <span style="color: #3548cf;">"name=ollama"</span>)

<span style="color: #77492f;"># </span><span style="color: #77492f;">Access container for direct troubleshooting</span>
docker exec -it $(docker ps -q --filter <span style="color: #3548cf;">"name=LibreChat-API"</span>) sh

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check environment variables</span>
env | sort

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check log file permissions</span>
find . -name <span style="color: #3548cf;">"*.log"</span> -exec chmod 777 {} <span style="color: #3548cf;">\;</span>

<span style="color: #531ab6;">exit</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Restart problematic services</span>
docker-compose -f deploy-compose.yml -f docker-compose.override.yml restart

<span style="color: #531ab6;">exit</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org73ee2cd" class="outline-4">
<h4 id="org73ee2cd"><span class="section-number-4">7.1.2.</span> Performance Optimization</h4>
<div class="outline-text-4" id="text-7-1-2">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: Performance monitoring and optimization</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Monitoring system performance and resource usage</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check system resources</span>
ssh EC2-LibreChat <span style="color: #3548cf;">'</span>
<span style="color: #3548cf;"># CPU and memory usage</span>
<span style="color: #3548cf;">top -bn1 | head -20</span>

<span style="color: #3548cf;"># Disk usage</span>
<span style="color: #3548cf;">df -h</span>

<span style="color: #3548cf;"># Docker resource usage</span>
<span style="color: #3548cf;">docker stats --no-stream</span>

<span style="color: #3548cf;"># Check if GPU is available and in use (for GPU instances)</span>
<span style="color: #3548cf;">nvidia-smi 2&gt;/dev/null || echo "No GPU detected"</span>
<span style="color: #3548cf;">'</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Monitor network connectivity</span>
ssh EC2-LibreChat <span style="color: #3548cf;">'netstat -tlnp | grep -E "(3080|11434|8000)"'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6f86a3c" class="outline-4">
<h4 id="org6f86a3c"><span class="section-number-4">7.1.3.</span> Cost Optimization Strategies</h4>
<div class="outline-text-4" id="text-7-1-3">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #77492f;"># </span><span style="color: #77492f;">Listing: AWS cost optimization</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">Managing AWS costs effectively</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Stop instance when not in use</span>
aws ec2 stop-instances --instance-ids <span style="color: #3548cf;">"$instance_id"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Start instance when needed</span>
aws ec2 start-instances --instance-ids <span style="color: #3548cf;">"$instance_id"</span>

<span style="color: #77492f;"># </span><span style="color: #77492f;">Check instance state</span>
aws ec2 describe-instances <span style="color: #3548cf;">\</span>
  --instance-ids <span style="color: #3548cf;">"$instance_id"</span> <span style="color: #3548cf;">\</span>
  --query <span style="color: #3548cf;">'Reservations[*].Instances[*].[InstanceId, State.Name]'</span> <span style="color: #3548cf;">\</span>
  --output text

<span style="color: #77492f;"># </span><span style="color: #77492f;">For development: use smaller instance types</span>
<span style="color: #77492f;"># </span><span style="color: #77492f;">For production: consider reserved instances or spot instances</span>
<span style="color: #8f0075;">echo</span> <span style="color: #3548cf;">"Current instance type: $(aws ec2 describe-instances --instance-ids $instance_id --query 'Reservations[*].Instances[*].InstanceType' --output text)"</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org306a28c" class="outline-2">
<h2 id="org306a28c"><span class="section-number-2">8.</span> Reflection &amp; Lessons Learned</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org6bc512b" class="outline-3">
<h3 id="org6bc512b"><span class="section-number-3">8.1.</span> Personal Insights from This Journey</h3>
<div class="outline-text-3" id="text-8-1">
<p>
Building this privacy-focused AI system has been both challenging and deeply rewarding. Here are my key discoveries:
</p>
</div>
<div id="outline-container-org1f976bd" class="outline-4">
<h4 id="org1f976bd"><span class="section-number-4">8.1.1.</span> Technical Insights</h4>
<div class="outline-text-4" id="text-8-1-1">
<ol class="org-ol">
<li><b><b>Container Orchestration</b></b>: Docker Compose provides an excellent balance between simplicity and functionality for this use case</li>
<li><b><b>Security by Design</b></b>: Implementing HTTPS from the start, rather than as an afterthought, creates a much more robust system</li>
<li><b><b>Local-Cloud Hybrid</b></b>: The combination of local Ollama models for embeddings and cloud Bedrock models for reasoning provides optimal privacy and performance</li>
<li><b><b>Infrastructure as Code</b></b>: Terraform automation makes the entire system reproducible and shareable</li>
</ol>
</div>
</div>
<div id="outline-container-org686dbb2" class="outline-4">
<h4 id="org686dbb2"><span class="section-number-4">8.1.2.</span> Methodology Insights</h4>
<div class="outline-text-4" id="text-8-1-2">
<ol class="org-ol">
<li><b><b>Live-Scripting Power</b></b>: The F4 execution method transforms documentation into executable infrastructure</li>
<li><b><b>Iterative Development</b></b>: Building in checkpoints allows for systematic troubleshooting and learning</li>
<li><b><b>Privacy First</b></b>: Self-hosting gives complete control but requires accepting operational responsibility</li>
</ol>
</div>
</div>
<div id="outline-container-org83426c3" class="outline-4">
<h4 id="org83426c3"><span class="section-number-4">8.1.3.</span> Unexpected Discoveries</h4>
<div class="outline-text-4" id="text-8-1-3">
<ol class="org-ol">
<li><b><b>Resource Requirements</b></b>: RAG functionality with Ollama requires careful instance sizing consideration</li>
<li><b><b>Network Configuration</b></b>: Docker networking for multi-container applications needs thoughtful planning</li>
<li><b><b>Model Performance</b></b>: Local embedding models perform surprisingly well for document processing</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org0ee617b" class="outline-3">
<h3 id="org0ee617b"><span class="section-number-3">8.2.</span> Alternative Approaches Considered</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-org4603286" class="outline-4">
<h4 id="org4603286"><span class="section-number-4">8.2.1.</span> Different Infrastructure Options</h4>
<div class="outline-text-4" id="text-8-2-1">
<ul class="org-ul">
<li><b><b>Kubernetes</b></b>: More complex but offers better scaling for production environments</li>
<li><b><b>AWS ECS/Fargate</b></b>: Serverless containers reduce operational overhead</li>
<li><b><b>Local Development</b></b>: Docker Desktop for development and testing</li>
</ul>
</div>
</div>
<div id="outline-container-orgf9b08a4" class="outline-4">
<h4 id="orgf9b08a4"><span class="section-number-4">8.2.2.</span> Security Enhancements for Production</h4>
<div class="outline-text-4" id="text-8-2-2">
<ul class="org-ul">
<li><b><b>VPN Access</b></b>: Restricting access through VPN rather than public internet</li>
<li><b><b>WAF Integration</b></b>: Web Application Firewall for additional protection</li>
<li><b><b>Monitoring</b></b>: CloudWatch or Prometheus for comprehensive monitoring</li>
</ul>
</div>
</div>
<div id="outline-container-org162737b" class="outline-4">
<h4 id="org162737b"><span class="section-number-4">8.2.3.</span> Cost Optimization Alternatives</h4>
<div class="outline-text-4" id="text-8-2-3">
<ul class="org-ul">
<li><b><b>Spot Instances</b></b>: Significant cost savings for development environments</li>
<li><b><b>ARM Instances</b></b>: Better price/performance for certain workloads</li>
<li><b><b>Multi-Region</b></b>: Disaster recovery and performance optimization</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge46e982" class="outline-3">
<h3 id="orge46e982"><span class="section-number-3">8.3.</span> Future Enhancement Possibilities</h3>
<div class="outline-text-3" id="text-8-3">
</div>
<div id="outline-container-org54faaad" class="outline-4">
<h4 id="org54faaad"><span class="section-number-4">8.3.1.</span> Advanced AI Features</h4>
<div class="outline-text-4" id="text-8-3-1">
<ol class="org-ol">
<li><b><b>Multi-Modal Support</b></b>: Image and audio processing capabilities</li>
<li><b><b>Custom Model Training</b></b>: Fine-tuning models for specific use cases</li>
<li><b><b>Agent Frameworks</b></b>: Integration with LangChain or similar frameworks</li>
</ol>
</div>
</div>
<div id="outline-container-org3fc93a1" class="outline-4">
<h4 id="org3fc93a1"><span class="section-number-4">8.3.2.</span> Production Hardening</h4>
<div class="outline-text-4" id="text-8-3-2">
<ol class="org-ol">
<li><b><b>High Availability</b></b>: Multi-AZ deployment with load balancing</li>
<li><b><b>Backup Strategy</b></b>: Automated data backup and recovery procedures</li>
<li><b><b>Monitoring &amp; Alerting</b></b>: Comprehensive observability stack</li>
</ol>
</div>
</div>
<div id="outline-container-org77381a7" class="outline-4">
<h4 id="org77381a7"><span class="section-number-4">8.3.3.</span> User Experience Improvements</h4>
<div class="outline-text-4" id="text-8-3-3">
<ol class="org-ol">
<li><b><b>Mobile Interface</b></b>: Progressive Web App for mobile access</li>
<li><b><b>User Management</b></b>: Advanced authentication and authorization</li>
<li><b><b>API Access</b></b>: RESTful API for programmatic access</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgf0015cc" class="outline-3">
<h3 id="orgf0015cc"><span class="section-number-3">8.4.</span> Final Thoughts</h3>
<div class="outline-text-3" id="text-8-4">
<p>
This project demonstrates that privacy-focused AI is not only possible but practical. The combination of open-source tools, cloud infrastructure, and careful security design creates a powerful platform that respects user privacy while delivering enterprise-grade AI capabilities.
</p>

<p>
The live-scripting methodology proved invaluable for both development and documentation. Each code block tells a story while remaining completely executable, making this workflow both educational and practical.
</p>

<p>
Most importantly, this approach puts control back in the hands of users. In an age of increasing concern about AI privacy and data sovereignty, self-hosted solutions like this provide a compelling alternative to cloud-only AI services.
</p>

<p>
Whether you're a privacy-conscious individual, a security-focused organization, or simply someone who wants to understand how AI systems work under the hood, this workflow provides a solid foundation for exploration and production deployment.
</p>

<p>
&#x2014;
</p>

<p>
<b>This completes the LibreChat AWS deployment using live-scripting methodology. Each code block is executable with F4 in Emacs using `send-line-to-vterm`, or can be copied and pasted into any terminal for the same results.</b>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2025-01-31</p>
<p class="author">Author: Privacy-Focused AI Implementation</p>
<p class="date">Created: 2025-05-31 Sat 11:32</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
